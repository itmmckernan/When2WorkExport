window.open(URL.createObjectURL(new Blob([JSON.stringify(Array.from(document.getElementsByClassName('maintab bwgtcolors')[0].children).slice(1).reduce((r, v, i, o) => !(i % 2)? [...r, [Array.from(o[i].firstChild.firstChild.children).map(e => e.getAttribute('onclick') === null ? NaN : new Date(e.getAttribute('onclick').split('=').slice(-1)[0].split("'")[0])), Array.from(o[i+1].firstChild.firstChild.children)]] : r, []).map(e => e[0].map((f, i) => [f, e[1][i]])).flat().filter(e => !isNaN(e[0]) && e[1].getAttribute('class') == "weekpubback").map(z => [{'Date': z[0], 'Shifts': Array.from(z[1].children).filter(e => e.nodeName != "IMG").reduce((p, e, i, o) => e.getAttribute('class') == 'skh'? p : [...p, ...Array.from(e.children).filter(u => u.nodeName == "DIV").map(q => [{'Position': o[o.map(e => e.getAttribute('class')).lastIndexOf('skh', i)].innerText, 'Employee': q.children[0].firstChild.nodeName == 'B' ? q.children[0].firstChild.innerText : 'UNASSIGNED', 'Start Time': new Date((e.firstChild.data.split(' - ')[0].slice(0, -2).includes(':') ? e.firstChild.data.split(' - ')[0].slice(0, -2) : e.firstChild.data.split(' - ')[0].slice(0, -2)) + ':00' + ' ' + e.firstChild.data.split(' - ')[0].slice(-2) + ' ' + z[0].toDateString().slice(4)), 'End Time': new Date((e.firstChild.data.split(' - ')[1].slice(0, -2).includes(':') ? e.firstChild.data.split(' - ')[1].slice(0, -2) : e.firstChild.data.split(' - ')[1].slice(0, -2)) + ':00' + ' ' + e.firstChild.data.split(' - ')[1].slice(-2) + ' ' + z[0].toDateString().slice(4))}][0])], [])}][0]))], {type: 'text/JSON'})), '_blank');
